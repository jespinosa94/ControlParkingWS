package master;

import master.Encriptador;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.util.Scanner;


public class Main {

	private static String leerKey() {
		//Lee el archivo key controlando excepciones
		String resultado = "";
		File fichero = new File(getCanonicalPath() + "key.txt");
		if(fichero.exists()) {
			try {
				FileReader fr = new FileReader(fichero);
				BufferedReader br = new BufferedReader(fr);
				String linea = br.readLine();
				resultado = linea;
				br.close();
				fr.close();
			}catch (Exception e){
				System.out.println("Error estableciendo la clave de cifrado: fichero corrupto (" + e.toString() + ")");
			}
		} else {
			System.out.println("Error: el fichero \"key.txt\" no se encuentra");
		}
		return resultado;
	}
	
	public static void main(String[] args) {
		Scanner reader = new Scanner(System.in);
		final String key = leerKey();
		String cadena = "";
		String resultado = "";
		
		Encriptador.setKey(key);
		System.out.println("Escribe la cadena a encriptar: ");
		cadena = reader.nextLine();
		resultado = Encriptador.encrypt(cadena.trim());
		System.out.println("Texto sin encriptar: " + cadena);
		System.out.println("Texto encriptado: " + resultado);
		System.out.println("Texto desencriptado: " + Encriptador.decrypt(resultado));
	}

}
