package master;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.PrintWriter;

public class Sonda {
	private String volumen = "30";
	private String fechaUltimoCambio = "20/09/2016 15:30:26";
	private String led = "4500";
	private String id = "0";
	private String ficheroAsociado;
	
	public Sonda() {
		
	}
	
	public String leerSonda(String s) {
		String lectura = "";
		File fichero = new File(System.getProperty("user.dir") + s);
		if(fichero.exists()) {
			try {
				FileReader fr = new FileReader(fichero);
				BufferedReader br = new BufferedReader(fr);
				String linea;
				while((linea = br.readLine()) != null) {
					if(linea.contains("Volumen")) {
						volumen = linea.split("=")[1];
					} else if(linea.contains("UltimaFecha")) {
						fechaUltimoCambio = linea.split("=")[1];
					} else if(linea.contains("Led")) {
						led = linea.split("=")[1];
					}
					lectura += linea;
				}
				br.close();
				fr.close();
			} catch(Exception e) {
				System.out.println("Error al leer el fichero del sensor: " + e.toString());
			}
		} else {
			try{
				String nombre = "sensor" + id + ".txt";
			    PrintWriter writer = new PrintWriter(nombre, "UTF-8");
			    writer.println("Volumen=30");
			    writer.println("UltimaFecha=20/09/2016 15:30:26");
			    writer.println("Led=4500");
			    writer.close();
			    leerSonda("/sensor" + id + ".txt");
			} catch (Exception e) {
			   System.out.println("Error creando el fichero por defecto del sensor " + id + ": " + e.toString());
			}
		}
		return lectura;
	}
}
